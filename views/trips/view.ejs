<%- include ('../partials/header.ejs') %>
<%- include ('../partials/body.ejs') %>

<div>
  <div class='title'>
    <h1><%=username%>'s trip to <%= trip.destination %></h1>
  </div>
  <div class='view-trip-buttons'>
    <form id="edit-button" method="post" action="/trips/edit-data/<%=trip.id%>">
      <input type="submit"  value="Edit Trip">
    </form>
    
    <form id="complete-edits-button" method="post" action="/trips/save-edits/<%=trip.id%>">
      <input type="submit"  value="Done">
    </form>
  </div>
</div>  



<div>
  <h3>Dates</h3>
  <p>Start date: <%=trip.startDate.toISOString().slice(0,10);%></p>
  <% if (editDate === true){%>
    <form id="edit-start-date-form" action="/trips/edit/<%=trip.id%>" method="post">
      <input id="start-date" type="date" name="startDate" required>
      <input type="submit" value="Submit Change">
    </form>
  <%}%>
  <p>End date: <%=trip.endDate.toISOString().slice(0,10);%></p>
  <% if (editDate === true){%>
    <form id="edit-end-date-form" action="/trips/edit/<%=trip.id%>" method="post">
      <input id="start-date" type="date" name="endDate" required>
      <input type="submit" value="Submit Change">
    </form>
  <%}%>

</div>

<div>
  <h4>Flights</h3>
<!-- Added fields to input flight data -->
  <% trip.flights.forEach((flight) => {%>
    <ul>
      Info
      <li>Departure City: <%= flight.departureCity %></li>
      <li>Airport: <%= flight.airport %></li>
      <li>Airline: <%= flight.airline %></li>
      <li>Date: <%= flight.departureCity %></li>
      <li>Departure Time: <%= flight.departureTime %></li>
      <li>Flight number: <%= flight.flightNumber %></li>
      <li>Booking reference: <%= flight.bookingReference %></li>
    </ul>
      <%});%>
 

  <% if (editDate === true){%>
  <form id="new-flight-form" action="/trips/add-flight/<%=trip.id%>" method="post">
    <label for="departure-city">Departure City </label>
    <input id="departure-city" type="text" name="departureCity" required>
    <label for="airport">Airport: </label>
    <input id="airport" type="text" name="airport" required>
    <label for="airline">Airline: </label>
    <input id="airline" type="text" name="airline" required>
    <label for="date">Date: </label>
    <input id="date" type="date" name="date" required>
    <label for="departure-time">Departure Time: </label>
    <input id="departure-time" type="text" name="departureTime" required>
    <label for="flight-number">Flight number: </label>
    <input id="flight-number" type="text" name="flightNumber" required>
    <label for="booking-reference">Booking reference: </label>
    <input id="booking-reference" type="text" name="bookingReference" required>
    <input type="submit" value="Add Flight">
  </form>
  <%}%>
</div>


<div>
  <h3>Accommodation</h3>
  <% trip.accommodations.forEach((accommodation) => {%>
    <ul>
      Info
      <li>Location: <%= accommodation.location %></li>
      <li>Start Date: <%= accommodation.startDate %></li>
      <li>End Date: <%= accommodation.endDate%></li>
      <li>Booking reference: <%= accommodation.bookingReference %></li>
    </ul>
      <%});%>
 

  <% if (editDate === true){%>
  <form id="new-accommodation-form" action="/trips/add-accommodation/<%=trip.id%>" method="post">
    <label for="location">location</label>
    <input id="location" type="text" name="location" required>
    <label for="start-date">Arrival Date: </label>
    <input id="start-date" type="date" name="startDate" required>
    <label for="end-date">Departure Date: </label>
    <input id="end-date" type="date" name="endDate" required>
    <label for="booking-reference">Booking reference: </label>
    <input id="booking-reference" type="text" name="bookingReference" required>
    <input type="submit" value="Add Accommodation">
  </form>
  <%}%>
</div>

<div>
  <h3>Companions</h3>
  <% trip.companionEmails.forEach((email) => {%>
    <li><%=email%></br>
    </li>
  <%});%>
  <% if (editDate === true){%>
    <form id="add-user-form" action="/trips/add-user/<%=trip.id%>" method="post">
      <input id="companion-email" type="text" name="companionEmails" placeholder="Please add your friend's email">
      <input type="submit" value="Submit Change">
    </form>
  <%}%>
</div>


<%- include ('../partials/footer.ejs') %>
